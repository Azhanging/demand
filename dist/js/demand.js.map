{"version":3,"sources":["webpack:///webpack/bootstrap ac97d75bcf6849bc265e","webpack:///./src/demand/fn.js","webpack:///./src/demand/error.js","webpack:///./src/demand/module.js","webpack:///./src/demand/path.js","webpack:///./src/demand/script.js","webpack:///./src/demand/config.js","webpack:///./src/demand/init.js","webpack:///./src/demand/queue.js","webpack:///./src/demand/compatibility.js","webpack:///./src/demand/demand.js","webpack:///./src/demand/dep.js","webpack:///./src/demand/shim.js","webpack:///./src/demand/use.js","webpack:///./src/index.js"],"names":["Fn","array","Array","obj","Object","fn","string","num","isNaN","cb","i","len","length","isArr","hasOwnProperty","context","args","isFn","apply","expr","tm","each","tmItem","index","replace","RegExp","options","option","key","error","errCode","msg","console","warn","hasModule","findModule","removeModule","setModule","isScriptModule","setScriptLoadedModule","m","path","call","module","pathModule","idModule","urlModule","opts","url","name","resetLastLoadedModule","lastLoader","lastLoadedModule","dep","type","findM","id","loadModules","isDemand","depManage","push","resolvePath","resolveJsExt","isHttpModule","HTTP","resolveAliasPath","resolveAlias","resPath","baseUrl","splitResPath","split","p","pop","join","test","ALIAS","lastIndex","alias","_alias","initRegExp","createScript","isCreateScript","runCreateScript","script","document","createElement","async","onload","next","onerror","remove","e","parentNode","removeChild","src","getElementsByTagName","appendChild","config","shim","paths","resetLastModule","_export_","setPaths","setAlias","demand","urlModules","pathModules","pathConfig","hasCreateScript","isStr","aliasPath","Queue","queue","hasVal","shift","prototype","indexOf","val","map","mapArr","filter","item","_this","use","status","undefined","origin","location","protocol","host","isConfig","extend","loadModule","isObj","global","window","depQueue","define","buildModuleDep","deps","demandDep","build","depExport","setShim","_shim","shimContext","useQueue","runUse","_module","cbDeps","depData","err","factory","version"],"mappings":"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","file":"js/demand.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ac97d75bcf6849bc265e","//常用方法\r\nclass Fn {\r\n\tisArr(array) {\r\n\t\treturn array instanceof Array;\r\n\t}\r\n\r\n\tisObj(obj) {\r\n\t\treturn obj instanceof Object && !(obj instanceof Array) && obj !== null;\r\n\t}\r\n\r\n\tisFn(fn) {\r\n\t\treturn typeof fn === 'function';\r\n\t}\r\n\tisStr(string) {\r\n\t\treturn typeof string === 'string';\r\n\t}\r\n\tisNum(num) {\r\n\t\treturn typeof num === 'number' || !isNaN(num);\r\n\t}\r\n\teach(obj, cb) { //遍历\r\n\t\tlet i = 0,\r\n\t\t\tlen = obj.length;\r\n\t\tif(this.isArr(obj)) {\r\n\t\t\tfor(; i < len; i++) {\r\n\t\t\t\tcb(obj[i], i);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tfor(i in obj) {\r\n\t\t\t\tif(obj.hasOwnProperty(i)) cb(obj[i], i);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tcb(cb, context, args) { //回调\r\n\t\targs = args ? args : [];\r\n\t\tthis.isFn(cb) ? (cb.apply(context, args)) : null;\r\n\t}\r\n\t//处理正则数据\r\n\tinitRegExp(expr) {\r\n\t\tconst tm = '\\\\/*.?+$^[](){}|\\'\\\"';\r\n\t\tthis.each(tm, (tmItem, index) => {\r\n\t\t\texpr = expr.replace(new RegExp('\\\\' + tmItem, 'g'), '\\\\' + tmItem);\r\n\t\t});\r\n\t\treturn expr;\r\n\t}\r\n\textend(obj, options) { //合并\r\n\t\tthis.each(options, (option, key) => {\r\n\t\t\tobj[key] = option;\r\n\t\t});\r\n\t\treturn obj;\r\n\t}\r\n}\r\n\r\nexport default new Fn();\n\n\n// WEBPACK FOOTER //\n// ./src/demand/fn.js","/*\r\n *\t错误处理 \r\n * */\r\n\r\nexport default function error(errCode, msg) {\r\n\tswitch(errCode) {\r\n\t\tcase 0:\r\n\t\t\tconsole.warn('只允许实例化一次！');\r\n\t\t\tbreak;\r\n\t\tcase 1:\r\n\t\t\tconsole.error(msg + '加载模块出错！');\r\n\t\t\tbreak;\r\n\t\tcase 2:\r\n\t\t\tconsole.error('模块使用有误，不能当前模块依赖于自身！');\r\n\t\t\tbreak;\r\n\t\tcase 3:\r\n\t\t\tconsole.error('非paths和dep中加载的模块（即直接加载script的模块需要添加id来识别模块）');\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tconsole.error('模块运行有误：' + msg);\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/demand/error.js","import fn from './fn';\r\n//初始化\r\nimport { setPaths } from './init';\r\n\r\nimport { resolvePath } from './path';\r\n\r\nimport { runCreateScript } from './script';\r\n\r\nimport { resetLastModule } from './config';\r\n\r\nimport error from './error';\r\n\r\n//has module in demand\r\nexport function hasModule(m) {\r\n\tconst path = resolvePath.call(this, m),\r\n\t\tmodule = this.module;\r\n\tif(module.pathModule[m] ||\r\n\t\tmodule.idModule[m] ||\r\n\t\tmodule.urlModule[path]\r\n\t) return true;\r\n\treturn false;\r\n}\r\n\r\n//find module in demand.module[path|url|id]  权重：path > url > id\r\nexport function findModule(m) {\r\n\tconst module = this.module,\r\n\t\tpath = resolvePath.call(this, m);\r\n\tif(module.pathModule[m]) return module.pathModule[m];\r\n\tif(module.urlModule[path]) return module.urlModule[path];\r\n\tif(module.idModule[m]) return module.idModule[m];\r\n\treturn false;\r\n}\r\n\r\n//del error module\r\nexport function removeModule(opts) {\r\n\tdelete this.module.urlModule[opts.url];\r\n\tdelete this.module.pathModule[opts.name];\r\n\tresetLastLoadedModule.call(this);\r\n}\r\n\r\n//set module config\r\nexport function setModule(opts) {\r\n\r\n\tconst lastLoader = this.module.lastLoadedModule;\r\n\r\n\tlet dep = lastLoader.dep;\r\n\r\n\t//把最后加载的模块内容加载进去\r\n\tfn.each(lastLoader, (module, type) => {\r\n\t\topts.findM[type] = module;\r\n\t});\r\n\r\n\t//扶弱当前的模块中存在id的名，设置id的模块\r\n\tif(lastLoader.id) {\r\n\t\tthis.module.idModule[lastLoader.id] = opts.findM;\r\n\t}\r\n\r\n\t//查看依赖，设置一下依赖\r\n\tif(dep.length > 0) {\r\n\t\tconst loadModules = setPaths.call(this, dep);\r\n\t\trunCreateScript.call(this, loadModules);\r\n\t}\r\n\r\n\t//设置初始化的状态\r\n\topts.findM.isDemand = false;\r\n\r\n\t//运行模块内容，返回接口\r\n\tthis.module.depManage.push(opts.findM);\r\n\r\n\t//重设最后的模块\r\n\tresetLastLoadedModule.call(this);\r\n}\r\n\r\n/*\r\n * 重设最后的模块,在http模块中会存在不同规格的内容，需要设置一个空的规格\r\n * */\r\nfunction resetLastLoadedModule() {\r\n\tthis.module.lastLoadedModule = resetLastModule;\r\n}\r\n\r\n//是否为script直接加载的模块\r\nexport function isScriptModule(module) {\r\n\tif(module !== resetLastModule) return true;\r\n\treturn false;\r\n}\r\n\r\n//设置script直接加载的模块\r\nexport function setScriptLoadedModule(module) {\r\n\t\r\n\tif(module.id === null) {\r\n\t\terror(3);\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tsetModule.call(this, {\r\n\t\turl: null,\r\n\t\tname: null,\r\n\t\tfindM: module\r\n\t});\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/demand/module.js","import fn from './fn';\r\n\r\nconst HTTP = /^http(s)?:\\/\\//;\r\n\r\n//路径处理\r\nexport function resolvePath(path) {\r\n    //如果是http的链接，直接返回直接的http链接\r\n    if(isHttpModule(path)){\r\n        return path;\r\n    }\r\n    \r\n    //处理完alias的路径\r\n    const resolveAliasPath = resolveAlias.call(this,path);\r\n    \r\n\tconst resPath = [this.baseUrl],\r\n\t\tsplitResPath = resolveAliasPath.split('/');\r\n\t\t\r\n\tfn.each(splitResPath, (p, index) => {\r\n\t\tswitch(p) {\r\n\t\t\tcase '':\r\n\t\t\t\tif(index === 0) resPath[index] = '';\r\n\t\t\t\tbreak;\r\n\t\t\tcase '.':\r\n\t\t\t\tbreak;\r\n\t\t\tcase '..':\r\n\t\t\t\tresPath.pop();\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tresPath.push(p);\r\n\t\t}\r\n\t});\r\n\t\r\n\treturn resPath.join('/').replace(/\\/{2,}/g,'\\/');;\r\n}\r\n\r\n//处理是否存在js后缀\r\nexport function resolveJsExt(url) {\r\n\tif(/\\.js/g.test(url)) return url;\r\n\telse return url + '.js';\r\n}\r\n\r\n//判断是否为http(s)的模块\r\nexport function isHttpModule(url){\r\n    return HTTP.test(url);\r\n}\r\n\r\nconst ALIAS = /@(.*?)/g; \r\n\r\n//处理alias的数据\r\nfunction resolveAlias(path){\r\n\tALIAS.lastIndex = 0;\r\n\t//如果不存在别名，直接返回路径\r\n\tif(!ALIAS.test(path)){\r\n\t\treturn path;\t\r\n\t}\r\n\t\r\n\t//存在别名，把别名替换掉\r\n\tfn.each(this.alias,(_alias,key)=>{\r\n\t\tALIAS.lastIndex = 0;\r\n\t\tif(!ALIAS.test(path)) return path;\r\n\t\tpath = path.replace(new RegExp(fn.initRegExp(key),'g'),_alias);\r\n\t});\r\n\t\r\n\treturn path;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/demand/path.js","import { findModule, setModule, removeModule } from './module';\r\n\r\nimport { resolveJsExt, isHttpModule } from './path';\r\n\r\nimport { queue } from './queue';\r\n\r\nimport fn from './fn';\r\n\r\nimport error from './error';\r\n\r\n//创建script节点\r\nexport function createScript(opts) {\r\n\tconst script = document.createElement('script');\r\n\t//获取模块\r\n\topts.findM = findModule.call(this, opts.url);\r\n\t//异步加载    \r\n\tscript.async = true;\r\n\r\n\tdelete opts.findM.createScript;\r\n\r\n\tscript.onload = () => {\r\n\t\tsetModule.call(this, opts);\r\n\t\tqueue.next();\r\n\t};\r\n\r\n\tscript.onerror = () => {\r\n\t\tremoveModule.call(this, opts);\r\n\t\terror(1, opts.url);\r\n\t\ttry {\r\n\t\t\tscript.remove();\r\n\t\t} catch(e) {\r\n\t\t\tscript.parentNode.removeChild(script);\r\n\t\t}\r\n\t\tqueue.next();\r\n\t};\r\n\r\n\tscript.type = \"text/javascript\";\r\n\r\n\t//先判断是否为http模块，否则就是baseUrl中的模块\r\n\tscript.src = isHttpModule(opts.url) ? opts.url : resolveJsExt(opts.url);\r\n\r\n\t//添加依赖队列数据\r\n\tqueue.push(false);\r\n\r\n\tdocument.getElementsByTagName('head')[0].appendChild(script);\r\n}\r\n\r\n//检测单前模块script是否加载了\r\nexport function isCreateScript(path) {\r\n\tconst findM = findModule.call(this, path);\r\n\tif(fn.isFn(findM.createScript)) {\r\n\t\treturn findM.createScript;\r\n\t} else {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n//运行插入模块\r\nexport function runCreateScript(loadModules) {\r\n\tfn.each(loadModules, (path, index) => {\r\n\t\tcreateScript.call(this, path);\r\n\t});\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/demand/script.js","/*默认配置参数*/\r\nexport const config = {\r\n\talias: {},\r\n\tshim: {},\r\n\tpaths: {}\r\n}\r\n\r\n/*设置默认reset的lastModule*/\r\nexport const resetLastModule = {\r\n\t_export_() {\r\n\t\treturn() => {}\r\n\t},\r\n\tdep: [],\r\n\tid: null\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/demand/config.js","import { resolvePath } from './path';\r\n\r\nimport { hasModule, findModule } from './module';\r\n\r\nimport { createScript, isCreateScript } from './script';\r\n\r\nimport fn from './fn';\r\n\r\n//设置模块路径\r\nexport function setPaths(paths) {\r\n\r\n\tconst loadModules = [];\r\n\r\n\tfn.each(paths, (path, name) => {\r\n\r\n\t\tconst demand = this,\r\n\t\t\tresPath = resolvePath.call(this, path), //处理完的路径\r\n\t\t\turlModules = this.module.urlModule, //通过url处理的模块\r\n\t\t\tpathModules = this.module.pathModule, //通过config中path的模块\r\n\t\t\tpathConfig = {\r\n\t\t\t\turl: resPath,\r\n\t\t\t\tname: name\r\n\t\t\t};\r\n\r\n\t\t//检查是否存在对应的模块，存在跳过\r\n\t\tif(hasModule.call(this, path)) {\r\n\t\t\tconst hasCreateScript = isCreateScript.call(this, path);\r\n\t\t\t//当前的模块是否被加载script\r\n\t\t\tif(hasCreateScript) {\r\n\t\t\t\thasCreateScript.call(this);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\turlModules[resPath] = {\r\n\t\t\tcreateScript() {\r\n\t\t\t\tcreateScript.call(demand, pathConfig);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//如果是从paths中配置的路径\r\n\t\tif(fn.isStr(name)) {\r\n\t\t\tpathModules[name] = urlModules[resPath];\r\n\t\t}\r\n\r\n\t\tloadModules.push(pathConfig);\r\n\t});\r\n\r\n\t//返回处理完的模块路径\r\n\treturn loadModules;\r\n}\r\n\r\n//设置别名路径\r\nexport function setAlias(alias) {\r\n\tconst aliasPath = {};\r\n\tfn.each(alias, (path, key) => {\r\n\t\taliasPath['@' + key] = path;\r\n\t});\r\n\treturn aliasPath;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/demand/init.js","/*\r\n    队列 \r\n * */\r\n\r\nexport default class Queue {\r\n    constructor(opts) {\r\n        this.queue = [];\r\n    }\r\n    push(fn) {\r\n        this.queue.push(fn);\r\n    }\r\n    next() {\r\n        if(this.hasVal()) {\r\n            this.queue.shift();\r\n        }\r\n        \r\n        if(this.queue.length === 0) this.cb();\r\n    }\r\n    hasVal(){\r\n    \treturn this.queue.length != 0;\r\n    }\r\n}\r\n\r\n//创建队列\r\nexport const queue = new Queue();\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/demand/queue.js","import fn from './fn';\r\n\r\n//兼容性IE8\r\n(function() {\r\n\r\n    //兼容IE8中 的indexOf\r\n    if(!fn.isFn(Array.prototype.indexOf)) {\r\n        Array.prototype.indexOf = function(val) {\r\n            let index = 0,\r\n                len = this.length;\r\n            for(; index < len; index++) {\r\n                if(this[index] === val) return index;\r\n            }\r\n            return -1;\r\n        }\r\n    }\r\n\r\n    //map\r\n    if(!fn.isFn(Array.prototype.map)) {\r\n        Array.prototype.map = function(fn) {\r\n            let mapArr = [],\r\n                i = 0,\r\n                len = this.length;\r\n            for(; i < len; i++) {\r\n                mapArr.push(fn(this[i], i));\r\n            }\r\n            return mapArr;\r\n        }\r\n    }\r\n\r\n    //filter\r\n    if(!fn.isFn(Array.prototype.filter)) {\r\n        Array.prototype.filter = function(fn) {\r\n            let mapArr = [],\r\n                i = 0,\r\n                len = this.length;\r\n            for(; i < len; i++) {\r\n                let item = this[i];\r\n                if(fn(item, i)) mapArr.push(item);\r\n            }\r\n            return mapArr;\r\n        }\r\n    }\r\n\r\n})();\n\n\n// WEBPACK FOOTER //\n// ./src/demand/compatibility.js","import { hasModule, findModule, setIdModule, isScriptModule, setScriptLoadedModule } from './module';\r\n\r\nimport { useQueue, checkRunUse, runUse } from './use';\r\n//初始化\r\nimport { setAlias, setPaths } from './init';\r\n\r\nimport { setShim } from './shim';\r\n\r\nimport { config, resetLastModule } from './config';\r\n\r\nimport { runCreateScript } from './script';\r\n\r\nimport error from './error';\r\n\r\nimport fn from './fn';\r\n\r\nexport default function demand(dep, cb) {\r\n\tconst _this = demand,\r\n\t\tmodule = _this.module;\r\n\t//运行依赖\r\n\tif(fn.isArr(dep)) {\r\n\t\tfn.each(dep, (name, index) => {\r\n\t\t\tif(!hasModule.call(_this, name)) return;\r\n\t\t\tconst findM = findModule.call(_this, name);\r\n\t\t\tfn.cb(findM.createScript, _this);\r\n\t\t});\r\n\r\n\t\t//存储回调，等所有的模块加载完毕后调用\r\n\t\tmodule.use.push({\r\n\t\t\tdep: dep,\r\n\t\t\tcb: cb\r\n\t\t});\r\n\r\n\t\tmodule.status ? runUse.call(_this) : null;\r\n\r\n\t} else if(fn.isFn(dep)) {\r\n\t\t/*\r\n\t\t * 使用情况：1.在模块全部加在后追加使用\r\n\t\t *          2.在模块加载依赖的时候使用\r\n\t\t * */\r\n\t\tmodule.use.push({\r\n\t\t\tdep: [],\r\n\t\t\tcb: dep\r\n\t\t});\r\n\r\n\t\tmodule.status ? runUse.call(_this) : null;\r\n\r\n\t} else if(fn.isStr(dep)) {\r\n\r\n\t\t//获取模块\r\n\t\tconst module = findModule.call(_this, dep);\r\n\t\t//这理由循环依赖的问题，如果当前的模块是未加载的，直接返回undefined\r\n\t\treturn module.isDemand ? module['_export_'] : undefined;\r\n\t}\r\n}\r\n\r\n//获取根路径\r\ndemand.origin = (function() {\r\n\treturn(location.origin || location.protocol + '//' + location.host);\r\n})();\r\n\r\n//是否config过\r\nlet isConfig = false;\r\n\r\n//配置\r\ndemand.config = function(opts) {\r\n\tif(isConfig) {\r\n\t\terror(0);\r\n\t\treturn;\r\n\t}\r\n\r\n\topts = fn.extend(config, opts);\r\n\r\n\t//设置源路径\r\n\tthis.baseUrl = opts.baseUrl ? opts.baseUrl : this.origin;\r\n\t//配置别名\r\n\tthis.alias = setAlias(opts.alias);\r\n\t//设置shim配置\r\n\tsetShim.call(this, opts.shim);\r\n\t//设置paths\r\n\tsetPaths.call(this, opts.paths);\r\n\t//设置queue的回调\r\n\tuseQueue.call(this);\r\n\t//只允许config一次\r\n\tisConfig = true;\r\n};\r\n\r\n//再config后以后加载模块\r\ndemand.loadModule = function(paths) {\r\n\tlet loadModules;\r\n\r\n\tif(fn.isObj(paths)) {\r\n\t\tloadModules = setPaths.call(this, paths);\r\n\t} else if(fn.isStr(paths)) {\r\n\t\tloadModules = setPaths.call(this, [paths]);\r\n\t}\r\n\r\n\trunCreateScript.call(this, loadModules);\r\n\r\n\tthis.module.status = false;\r\n}\r\n\r\n//设置一下全局的环境\r\ndemand.global = typeof window !== undefined ? window : this;\r\n\r\n//模块存储\r\ndemand.module = {\r\n\tpathModule: {}, //config中的path模块\r\n\tidModule: {}, //id模块\r\n\turlModule: {}, //url路径的模块\r\n\tuse: [], //use集合\r\n\tlastLoadedModule: resetLastModule, //最后获取到的模块\r\n\tdepManage: [], //依赖管理\r\n\tdepQueue: [], //依赖队列\r\n\tstatus: false //全部的use加载状态\r\n};\r\n\r\n//加载模块\r\ndemand.define = function(id, dep, cb) {\r\n\tconst module = {};\r\n\t//存在id的模块\r\n\tif(fn.isStr(id)) {\r\n\t\tmodule['id'] = id;\r\n\t\tif(fn.isArr(dep)) {\r\n\t\t\tmodule['dep'] = dep;\r\n\t\t\tmodule['_export_'] = cb;\r\n\t\t} else if(fn.isFn(dep)) {\r\n\t\t\tmodule['dep'] = [];\r\n\t\t\tmodule['_export_'] = dep;\r\n\t\t}\r\n\t} else if(fn.isArr(id)) {\r\n\t\tmodule['id'] = null;\r\n\t\tmodule['dep'] = id;\r\n\t\tmodule['_export_'] = dep;\r\n\t} else if(fn.isFn(id)) {\r\n\t\tmodule['id'] = null;\r\n\t\tmodule['dep'] = [];\r\n\t\tmodule['_export_'] = id;\r\n\t} else {\r\n\t\tthrow('error');\r\n\t}\r\n\t/*\r\n\t *\t检查非paths或者是dep中加载的模块设置\r\n\t * */\r\n\r\n\tif(isScriptModule(this.module.lastLoadedModule)) {\r\n\t\tsetScriptLoadedModule.call(this, this.module.lastLoadedModule);\r\n\t}\r\n\r\n\t//设置到最后一个接\r\n\tthis.module.lastLoadedModule = module;\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/demand/demand.js","import fn from './fn';\r\n\r\nimport { findModule } from './module';\r\n\r\nimport error from './error';\r\n\r\n/*\r\n *\t设置模块内的依赖depData \r\n * \t{\r\n * \t\tdep:[dep1,dep2],\r\n * \t\tmodule:module\r\n * \t}\r\n * */\r\n\r\nexport function buildModuleDep(module) {\r\n\tconst deps = module.dep,\r\n\t\tdemandDep = [];\r\n\r\n\tmodule.build = true;\r\n\r\n\t//初始化模块依赖\r\n\tfn.each(deps, (dep) => {\r\n\t\tconst findM = findModule.call(this, dep),\r\n\t\t\tdepExport = findM._export_;\r\n\r\n\t\t//自己依赖自己的话，返回undefined\r\n\t\tif(module === findM) {\r\n\t\t\tdemandDep.push(undefined);\r\n\t\t} else {\r\n\t\t\t/*\r\n\t\t\t *\t有关循环依赖的问题问题\r\n\t\t\t * */\r\n\r\n\t\t\tif(findM && !findM.build) {\r\n\t\t\t\tbuildModuleDep.call(this, findM);\r\n\t\t\t}\r\n\r\n\t\t\tif(!findM.isDemand) {\r\n\t\t\t\tdemandDep.push(undefined);\r\n\t\t\t} else {\r\n\t\t\t\tdemandDep.push(findM._export_);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t//初始化模块接口\r\n\tif(!module.isDemand) {\r\n\t\tmodule._export_ = module._export_.apply(this, demandDep);\r\n\t\tmodule.isDemand = true;\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/demand/dep.js","/*\r\n *\t设置垫片库 \r\n * */\r\nimport fn from './fn';\r\n\r\nimport { setModule } from './module';\r\n\r\nexport function setShim(shim) {\r\n\tfn.each(shim, (_shim, id) => {\r\n\t\t\r\n\t\tthis.define(id, _shim.dep, () => {\r\n\t\t\treturn shimContext.call(this, _shim);\r\n\t\t});\r\n\t\t\r\n\t\tconst lastLoadedModule = this.module.lastLoadedModule;\r\n\t\t\r\n\t\tsetModule.call(this, {\r\n\t\t\turl: null,\r\n\t\t\tname: null,\r\n\t\t\tfindM: lastLoadedModule\r\n\t\t});\r\n\t});\r\n}\r\n\r\n//处理shim中作用域和export接口\r\nfunction shimContext(_shim) {\r\n\tconst context = _shim.context || this.global,\r\n\t\t_export_ = _shim._export_;\r\n\tif(fn.isFn(_shim._export_)) {\r\n\t\treturn _export_.call(context);\r\n\t}\r\n\treturn context[_shim._export_];\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/demand/shim.js","import { buildModuleDep } from './dep';\r\n\r\nimport { queue } from './queue';\r\n\r\nimport fn from './fn';\r\n\r\nimport error from './error';\r\n\r\n//设置模块的依赖队列和use中的cb\r\nexport function useQueue() {\r\n\tqueue.cb = () => {\r\n\t\tconst module = this.module;\r\n\t\t//设置dep的依赖\r\n\t\twhile(module.depManage.length !== 0) {\r\n\t\t\tconst _module = module.depManage.shift();\r\n\t\t\tbuildModuleDep.call(this, _module);\r\n\t\t}\r\n\t\t//处理use\r\n\t\trunUse.call(this);\r\n\t\t//第一次的模块加载全部完毕\r\n\t\tmodule.status = true;\r\n\t}\r\n}\r\n\r\n//运行依赖\r\nexport function runUse() {\r\n\tconst module = this.module;\r\n\tlet cbDeps = [];\r\n\t\r\n\t//异步加载并发出现use顺序加载问题\r\n\tif(queue.hasVal()) return;\r\n\t\r\n\twhile(module.use.length !== 0) {\r\n\t\tconst depData = module.use.shift();\r\n\t\tfn.each(depData.dep, (dep, index) => {\r\n\t\t\tcbDeps.push(this(dep));\r\n\t\t});\r\n\r\n\t\ttry {\r\n\t\t\tdepData.cb.apply(this, cbDeps);\r\n\t\t} catch(err) {\r\n\t\t\terror(null, err);\r\n\t\t}\r\n\r\n\t\t//依赖处理完后清空\r\n\t\tcbDeps = [];\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/demand/use.js","//demand文件入口\r\nimport demand from './demand/demand.js';\r\n//兼容性处理\r\nimport compatibility from './demand/compatibility';\r\n\r\n(function(global, factory) {\r\n    (global ? (global.demand = factory()) : {});\r\n})(typeof window !== 'undefined' ? window : this, function() {\r\n\r\n    demand.version = \"v1.0.0\";\r\n\r\n    return demand;\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}